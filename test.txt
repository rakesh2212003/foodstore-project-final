test card number = 4000003560000008

stripe listen --forward-to http://127.0.0.1:5001/foodstore-project-final/us-central1/app/api/products/webhook

stripe trigger payment_intent.succeeded

let endpointSecret;
// endpointSecret = process.env.WEBHOOK;

router.post('/webhook', express.raw({ type: 'application/json' })), (req, res) => {
    const sig = req.headers["stripe-signature"];

    let eventType;
    let data;

    if (endpointSecret) {
        let event;
        try {
            event = stripe.webhooks.constructEvent(req.body, sig, endpointSecret);
        }
        catch (err) {
            res.status(400).send(`Webhooks Error: ${err.message}`);
            return;
        }
        data = event.data.object;
        eventType = event.type;
    } else {
        data = req.body.data.object;
        eventType = req.body.type;
    }

    if (eventType === "checkout.session.completed") {
        // stripe.customers.retrive(data.customer).then((customer) => {
            // console.log("Customer", customer)
            console.log("Data", data)
        // })
    }
}